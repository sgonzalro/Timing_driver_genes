# Timing_driver_genes
Timing analysis of most recurrent driver genes as a contribution to PCAWG-11


## Input files

The script needs 4 files to be run:

- TableS2_driver_point_mutations: File not privided but can be obtained from [PCAWG Drivers' table](https://www.synapse.org/#!Synapse:syn11639580)
- Purity and ploidy: file containing purity and ploidy of each sample
- Patients tissue file info: R object file containing minor patient information.

## Analysis workflow
```
load("TableS2_driver_point_mutations_annotation.RData")  #or equivalent read.table to TableS2_driver_point_mutations generated by PCAWG
CANCERGENES <- levels(finalDrivers$ID)

finalGenotypes <- Genotypes(path_snv_timing_VCFs, path_indel_timing_VCFs) ## both files can be obtained running [MutationTimeR](https://github.com/gerstung-lab/MutationTimeR)

purity_ploidy <- read.table(purity_ploidy_file, header = TRUE, stringsAsFactors = FALSE)
load("2017_02_Patients_tissue_colors.Rdata", verbose = TRUE) #sample2donor, specimenData and tissueColors files

odds_top50 <- timing_drivers(finalGenotypes, purity_ploidy, tissueColors, sample2donor, specimenData, 50)
odds_top50$plot
```
![Odds driver genes](https://github.com/sgonzalro/Timing_driver_genes/blob/master/data/odds_top50.png)

```
odds_tp53 <- timing_tp53(finalGenotypes, purity_ploidy, tissueColors, sample2donor, specimenData, odds_top50[["count_genes"]])
odds_tp53$plot
```
![Odds TP53](https://github.com/sgonzalro/Timing_driver_genes/blob/master/data/odds_tp53.png)

```
save(list(odds_top50 = odds_top50, odds_tp53 = odds_tp53), file = "final_results.RData")
```

## Output description

- odds_top50: List containing 3 objetcs:
  - data: results from the analysis, including odds ratio, error range, etc.
  - plot: 3 sections plot describing the results (see publication's figure 3)
  - count_genes: objetct needed to run the tp53 analysis
- odds_tp53: List cointaining 2 objetcs:
  - data: similar to odds_top50 object cointaing the odds numerbs.
  - plot: TP53 plot accross the different tumour types
